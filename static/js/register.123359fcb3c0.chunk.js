import{h as U,ba as J,aa as K,n as N,a9 as V,r as x,j as e,F as A,b0 as R,l as F,B as T,i as o,aJ as a,ah as g,bb as _,an as m,bc as y,bd as w,be as X,bf as Y,bg as Z,bi as C,T as S,bj as ee,bk as re,aG as W,m as k,bh as ie,ao as te}from"./vendor.dee56adfed90.chunk.js";import{A as ae}from"./AuthWrapper.6496e452e81f.chunk.js";import{c as se,a as b,b as ne,d as j,F as oe}from"./formik.esm.653f75db69cb.chunk.js";import{S as le,O as de,s as ce,a as me}from"./password-strength.32721eaa0d38.chunk.js";import{c as pe,d as ue,I as he,b as ge}from"./index.23055111bb7c.js";import{A as _e}from"./AnimateButton.3d32280d3b29.chunk.js";import{u as we}from"./useQuery.db1fd724ce76.chunk.js";import"./hey-listen.es.3d38fef0dd76.chunk.js";const be=()=>{var P;const u=U(),M=J(),O=K(),{t}=N("common"),{enqueueSnackbar:q}=V(),B=we(),[$]=pe(),{data:r}=ue(),[d,E]=x.useState(),[f,G]=x.useState(!1),L=()=>{G(!f)},D=i=>{i.preventDefault()},I=i=>{const n=ce(i);E(me(n))};x.useEffect(()=>{I("")},[]);const z=x.useMemo(()=>se().shape({email:b().email(t("register.email_invalid").toString()).max(255,t("register.email_max",{count:255}).toString()).required(t("register.email_required").toString()),password:b().min(8,t("register.password_min",{count:8}).toString()).max(255,t("register.password_max",{count:255}).toString()).required(t("register.password_required").toString()),password_confirm:b().oneOf([ne("password"),null],t("register.password_confirm_invalid").toString()).required(t("register.password_confirm_required").toString()),invite_code:r!=null&&r.is_invite_force?b().required(t("register.invite_code_required").toString()):b().max(8,t("register.invite_code_max").toString()),email_code:r!=null&&r.is_email_verify?j().required(t("register.email_code_required").toString()):j().negative()}),[t,r==null?void 0:r.is_invite_force,r==null?void 0:r.is_email_verify]);return e(A,{children:e(oe,{initialValues:{email:"",password:"",password_confirm:"",invite_code:(P=B.get("code"))!=null?P:"",email_code:"",agree:!1,submit:null},validationSchema:z,onSubmit:async(i,{setErrors:n,setStatus:l,setSubmitting:v})=>{if(!i.agree){l({success:!1}),n({submit:t("register.agree_required").toString()}),v(!1);return}try{await $({email:i.email,password:i.password,invite_code:i.invite_code,email_code:r!=null&&r.is_email_verify?i.email_code:""}).unwrap().then(()=>{l({success:!0}),q(t("notice::register_success"),{variant:"success"}),O("/dashboard",{replace:!0}),R.event("register",{category:"auth",label:"register",method:"email",success:!0,email:i.email,password_strength:d==null?void 0:d.label,invite_code:i.invite_code})},s=>{l({success:!1}),n(F.isEmpty(s.errors)?{submit:s.message}:s.errors),q(s.message,{variant:"error"}),R.event("register",{category:"auth",label:"register",method:"email",success:!1,error:s.message,email:i.email,values:i})})}catch(s){console.error(s),M.current&&(l({success:!1}),n(F.isEmpty(s.errors)?{submit:s.message}:s.errors),q(t("notice::register_failed"),{variant:"error"}))}finally{v(!1)}},children:({errors:i,handleBlur:n,handleChange:l,handleSubmit:v,isSubmitting:s,touched:c,values:h,setValues:H})=>e(T,{component:"form",onSubmit:v,children:o(a,{container:!0,spacing:3,children:[e(a,{item:!0,xs:12,children:o(g,{spacing:1,children:[e(_,{htmlFor:"email",children:e(m,{children:"register.email"})}),e(y,{fullWidth:!0,error:!!(c.email&&i.email),id:"email",type:"email",value:h.email,name:"email",onBlur:n,onChange:l,placeholder:"user@example.com",inputProps:{},endAdornment:(r==null?void 0:r.is_email_verify)===1?e(le,{email:h.email}):void 0}),c.email&&i.email&&e(w,{error:!0,id:"helper-text-email-signup",children:i.email})]})}),(r==null?void 0:r.is_email_verify)===1&&e(A,{children:e(a,{item:!0,xs:12,children:o(g,{spacing:1,children:[e(_,{htmlFor:"email-code-signup",children:e(m,{children:"register.email_code"})}),e(de,{value:h.email_code,onChange:p=>{H(Q=>({...Q,email_code:p}))},numInputs:6,containerStyle:{justifyContent:"space-between"},inputStyle:{width:"100%",margin:"8px",padding:"10px",border:"1px solid ".concat(u.palette.mode==="dark"?u.palette.grey[200]:u.palette.grey[300]),borderRadius:4,":hover":{borderColor:u.palette.primary.main}},focusStyle:{outline:"none",boxShadow:u.customShadows.primary,border:"1px solid ".concat(u.palette.primary.main)}}),c.email_code&&i.email_code&&e(w,{error:!0,id:"helper-text-email-signup",children:i.email_code})]})})}),o(a,{item:!0,xs:12,children:[o(g,{spacing:1,children:[e(_,{htmlFor:"password-signup",children:e(m,{children:"register.password"})}),e(y,{fullWidth:!0,error:!!(c.password&&i.password),id:"password-signup",type:f?"text":"password",value:h.password,name:"password",onBlur:n,onChange:p=>{l(p),I(p.target.value)},autoComplete:"new-password",endAdornment:e(X,{position:"end",children:e(he,{"aria-label":"toggle password visibility",onClick:L,onMouseDown:D,edge:"end",color:"secondary",children:f?e(Y,{}):e(Z,{})})}),placeholder:"******",inputProps:{}}),c.password&&i.password&&e(w,{error:!0,id:"helper-text-password-signup",children:i.password})]}),e(C,{fullWidth:!0,sx:{mt:2},children:o(a,{container:!0,spacing:2,alignItems:"center",children:[e(a,{item:!0,children:e(T,{sx:{bgcolor:d==null?void 0:d.color,width:85,height:8,borderRadius:"7px"}})}),e(a,{item:!0,children:e(S,{variant:"subtitle1",fontSize:"0.75rem",children:t("register.password_strength",{context:F.lowerCase(d==null?void 0:d.label)}).toString()})})]})})]}),e(a,{item:!0,xs:12,children:o(g,{spacing:1,children:[e(_,{htmlFor:"password-confirm",children:e(m,{children:"register.password_confirm"})}),e(y,{fullWidth:!0,error:!!(c.password_confirm&&i.password_confirm),id:"password-confirm",type:f?"text":"password",value:h.password_confirm,name:"password_confirm",onBlur:n,onChange:p=>{l(p),I(p.target.value)},autoComplete:"new-password",placeholder:"******",inputProps:{}}),c.password_confirm&&i.password_confirm&&e(w,{error:!0,id:"helper-text-password-confirm",children:i.password_confirm})]})}),e(a,{item:!0,xs:12,children:o(g,{spacing:1,children:[e(_,{htmlFor:"invite-code-signup",required:(r==null?void 0:r.is_invite_force)===1,children:e(m,{children:"register.invite_code"})}),e(y,{fullWidth:!0,error:!!(c.invite_code&&i.invite_code),id:"invite-code-signup",type:"text",value:h.invite_code,name:"invite_code",onBlur:n,onChange:l,required:(r==null?void 0:r.is_invite_force)===1,placeholder:t("register.invite_code_placeholder",{context:(r==null?void 0:r.is_invite_force)===1?"required":"optional"}).toString(),inputProps:{},disabled:B.get("code")!==null}),c.invite_code&&i.invite_code&&e(w,{error:!0,id:"helper-text-email-signup",children:i.invite_code})]})}),e(a,{item:!0,xs:12,children:e(ee,{value:!1,control:e(re,{}),name:"agree",id:"agree",onBlur:n,onChange:l,"aria-required":!0,sx:{alignItems:"flex-start"},label:e(S,{variant:"body2",sx:{lineHeight:2.9},children:o(m,{i18nKey:"register.license_agree",children:[e(W,{id:"terms-of-service",variant:"subtitle2",component:k,to:"https://swyvpn.com/"}),e(W,{id:"privacy-policy",variant:"subtitle2",component:k,to:"https://swyvpn.com/"})]})})})}),e(a,{item:!0,xs:12,children:e(_e,{children:e(ie,{disableElevation:!0,disabled:s,fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"primary",children:s?e(te,{size:24,color:"inherit"}):e(m,{children:"register.submit"})})})})]})})})})},ke=()=>(ge("register"),e(ae,{children:o(a,{container:!0,spacing:3,children:[e(a,{item:!0,xs:12,children:o(g,{direction:"row",justifyContent:"space-between",alignItems:"baseline",sx:{mb:{xs:-.5,sm:.5}},children:[e(S,{variant:"h3",children:e(m,{children:"register.title"})}),e(S,{component:k,to:"/login",variant:"body1",sx:{textDecoration:"none"},color:"primary",children:e(m,{children:"register.go-login"})})]})}),e(a,{item:!0,xs:12,children:e(be,{})})]})}));export{ke as default};
